# Enable USB HID
CONFIG_ZMK_USB=y

# CRITICAL: Disable NFC to use pins D4/D5 as GPIOs (required for Totem matrix)
CONFIG_NFCT_PINS_AS_GPIOS=y

# Enable Bluetooth
CONFIG_BT=y
CONFIG_ZMK_BLE=y

# Set keyboard name
CONFIG_ZMK_KEYBOARD_NAME="Totem"

# Increase Bluetooth transmit power for better reliability
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# Split keyboard BLE settings
CONFIG_ZMK_SPLIT=y
CONFIG_ZMK_SPLIT_BLE=y

# Force central role on left side
CONFIG_ZMK_SPLIT_ROLE_CENTRAL=y

# IMPORTANT: Output selection - prefer BLE over USB when both are connected
CONFIG_ZMK_BLE_CLEAR_BONDS_ON_START=n
CONFIG_ZMK_USB_INIT_PRIORITY=49

# Bluetooth connection stability settings
CONFIG_BT_GATT_ENFORCE_SUBSCRIPTION=n
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=6
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=12

# Power settings for battery operation
CONFIG_ZMK_IDLE_TIMEOUT=30000
CONFIG_ZMK_SLEEP=n
CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=900000

# Bluetooth connection settings
CONFIG_BT_MAX_CONN=3
CONFIG_BT_MAX_PAIRED=3

# Enable battery reporting
CONFIG_ZMK_BATTERY_REPORTING=y
CONFIG_ZMK_BATTERY_REPORT_INTERVAL=60

# System settings
CONFIG_ZMK_COMBO_MAX_COMBOS_PER_KEY=50
CONFIG_ZMK_KSCAN_DEBOUNCE_PRESS_MS=1
CONFIG_ZMK_KSCAN_DEBOUNCE_RELEASE_MS=5